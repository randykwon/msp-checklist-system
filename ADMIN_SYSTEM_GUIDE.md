# MSP 헬퍼 관리자 시스템 가이드

## 🔒 개요

MSP 헬퍼 관리자 시스템은 AWS MSP 파트너 프로그램 자체 평가 시스템의 관리자 전용 인터페이스입니다. 보안을 위해 메인 애플리케이션과 독립된 포트(3011)에서 운영됩니다.

## 🚀 시작하기

### 1. 관리자 계정 생성

```bash
# 관리자 계정 생성 (최초 1회만 실행)
node create-admin.js
```

**기본 관리자 계정:**
- 이메일: `admin@msp.com`
- 비밀번호: `admin123!`
- ⚠️ 첫 로그인 후 반드시 비밀번호를 변경하세요!

### 2. 관리자 시스템 실행

```bash
# 관리자 시스템 시작
./start-admin.sh
```

또는 수동으로:

```bash
cd msp-checklist/admin
npm install  # 최초 1회만
npm run dev
```

### 3. 접속

- **관리자 시스템**: http://localhost:3011
- **메인 시스템**: http://localhost:3010

### 4. 로그인 기능

**보안 강화 기능:**
- **이메일 기억하기**: 체크박스 선택 시 다음 로그인에서 이메일 자동 입력
- **인간 인증(CAPTCHA)**: 수학 문제 기반 봇 방지 시스템
  - 덧셈, 뺄셈, 곱셈 문제 랜덤 생성
  - 🔄 버튼으로 새로운 문제 생성 가능
  - 로그인 실패 시 자동으로 새 문제 생성

## 🔧 주요 기능

### 📊 대시보드
- 전체 시스템 통계 확인
- 사용자, Q&A, 캐시 현황 모니터링
- 빠른 액션 메뉴

### 👥 사용자 관리
- **전체 사용자 목록 조회**: 모든 등록된 사용자 확인
- **➕ 사용자 등록**: 새로운 사용자 계정 생성
  - 이름, 이메일, 비밀번호 (필수)
  - 역할 선택 (사용자/관리자)
  - 전화번호, 소속 정보 (선택)
- **✏️ 사용자 정보 수정**: 기존 사용자 정보 편집
  - 이름, 이메일, 전화번호, 소속 수정
- **👤 역할 변경**: 사용자 권한 관리 (user ↔ admin)
- **🔄 상태 관리**: 사용자 계정 상태 제어
  - **활성**: 정상적으로 시스템 사용 가능
  - **일시중지**: 임시로 시스템 접근 차단
  - **비활성**: 계정 비활성화
- **🗑️ 사용자 삭제**: 사용자 계정 완전 삭제
- **🔍 고급 검색 및 필터링**:
  - 이름, 이메일, 소속으로 검색
  - 상태별 필터 (활성/일시중지/비활성)
  - 역할별 필터 (사용자/관리자)
- **📊 사용자 활동 통계**: 질문/답변 활동 모니터링

### 💬 질의응답 관리
- **전체 질문 보기**: 모든 질문을 한 번에 확인
- **고급 필터링**: 상태별(전체/미답변/답변완료), 유형별(사전요구사항/기술검증) 필터
- **실시간 검색**: 질문 내용, 항목 ID, 사용자명으로 검색
- **정렬 기능**: 날짜순, 상태순, 유형순 정렬 (오름차순/내림차순)
- **통계 대시보드**: 전체 질문 수, 답변 완료율, 유형별 분포 확인
- **🤖 AI 자동 답변**: LLM을 활용한 지능형 답변 자동 생성
  - OpenAI GPT, Google Gemini, Anthropic Claude 지원
  - MSP 전문 컨텍스트 기반 답변 생성
  - 생성된 답변 검토 및 수정 가능
- **✏️ 답변 수정**: 기존 답변 편집 및 개선
  - 답변완료된 질문의 답변 내용 수정
  - AI로 새로운 답변 재생성 가능
  - 수정 시간 자동 업데이트
- **답변 관리**: 미답변 질문에 대한 답변 작성 및 관리
- **질문별 상세 정보**: 질문자, 작성일시, 답변자, 답변일시 등 상세 정보

### 📈 시스템 모니터링
- 사용자 활동 모니터링
- 캐시 사용량 확인 및 관리
- 시스템 성능 지표
- 캐시 데이터 삭제 기능

## 🔐 보안 기능

### 인증 및 권한
- JWT 기반 인증 (24시간 유효)
- 관리자 권한 필수
- 독립된 쿠키 도메인
- 자동 로그아웃

### 접근 제어
- 관리자 계정만 로그인 가능
- API 엔드포인트 권한 검증
- 자기 계정 보호 (삭제/역할변경 불가)

## 📁 시스템 구조

```
msp-checklist/admin/
├── app/                    # Next.js 앱 라우터
│   ├── dashboard/         # 대시보드 페이지
│   ├── users/            # 사용자 관리 페이지
│   ├── qa/               # Q&A 관리 페이지
│   ├── monitoring/       # 시스템 모니터링 페이지
│   ├── login/            # 로그인 페이지
│   └── api/              # API 라우트
├── components/           # 공통 컴포넌트
├── contexts/            # React 컨텍스트
├── lib/                 # 유틸리티 라이브러리
└── package.json         # 의존성 관리
```

## 🔧 환경 설정

### 환경 변수 (.env.local)
```env
# JWT Secret for Admin Authentication
JWT_SECRET=your-admin-jwt-secret-key
NODE_ENV=development

# LLM Provider Configuration (선택사항)
LLM_PROVIDER=openai  # openai, gemini, claude 중 선택

# API Keys (사용할 프로바이더의 키만 설정)
OPENAI_API_KEY=your-openai-api-key-here
GEMINI_API_KEY=your-gemini-api-key-here
CLAUDE_API_KEY=your-claude-api-key-here
```

**LLM 설정 참고:**
- API 키가 없어도 더미 프로바이더로 테스트 가능
- 실제 AI 답변을 원하면 해당 프로바이더의 API 키 설정 필요
- 프로바이더별 특징:
  - **OpenAI**: GPT-4o-mini 모델 사용, 안정적이고 빠른 응답
  - **Gemini**: Google의 Gemini-1.5-flash 모델, 무료 할당량 제공
  - **Claude**: Anthropic의 Claude-3.5-sonnet 모델, 높은 품질의 답변

### 포트 설정
- 관리자 시스템: **3011**
- 메인 시스템: **3010**

## 📊 API 엔드포인트

### 인증
- `POST /api/auth/login` - 관리자 로그인
- `POST /api/auth/logout` - 로그아웃
- `GET /api/auth/me` - 현재 사용자 정보

### 대시보드
- `GET /api/dashboard/stats` - 대시보드 통계

### 사용자 관리
- `GET /api/users` - 사용자 목록 조회
- `POST /api/users/create` - 새 사용자 생성
- `PUT /api/users/update` - 사용자 정보 수정
- `PUT /api/users/role` - 사용자 역할 변경
- `PUT /api/users/status` - 사용자 상태 변경
- `DELETE /api/users/[id]` - 사용자 삭제

### Q&A 관리
- `GET /api/qa/all` - 전체 질문 목록
- `GET /api/qa/unanswered` - 미답변 질문 목록
- `POST /api/qa/answer` - 질문 답변

### 모니터링
- `GET /api/monitoring/stats` - 모니터링 통계
- `DELETE /api/monitoring/cache/[type]` - 캐시 삭제

## 🚨 주의사항

### 보안
1. **기본 비밀번호 변경**: 첫 로그인 후 반드시 비밀번호 변경
2. **JWT 시크릿 변경**: 프로덕션 환경에서는 강력한 JWT 시크릿 사용
3. **HTTPS 사용**: 프로덕션에서는 HTTPS 필수
4. **방화벽 설정**: 관리자 포트(3011) 접근 제한

### 운영
1. **정기 백업**: 데이터베이스 정기 백업
2. **로그 모니터링**: 시스템 로그 정기 확인
3. **권한 관리**: 관리자 권한 최소화 원칙
4. **업데이트**: 정기적인 보안 업데이트

## 🔄 업데이트 및 유지보수

### 의존성 업데이트
```bash
cd msp-checklist/admin
npm update
```

### 빌드 및 배포
```bash
cd msp-checklist/admin
npm run build
npm start
```

## 📞 지원

문제가 발생하거나 추가 기능이 필요한 경우:
1. 시스템 로그 확인
2. 데이터베이스 상태 점검
3. 네트워크 연결 확인

## 📝 변경 이력

- **v1.0.0**: 초기 관리자 시스템 구축
  - 사용자 관리 기능
  - Q&A 관리 기능
  - 시스템 모니터링 기능
  - 보안 인증 시스템