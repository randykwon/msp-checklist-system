# Production values for msp-checklist

global:
  imageRegistry: "ACCOUNT_ID.dkr.ecr.us-east-1.amazonaws.com"
  imagePullPolicy: Always
  storageClass: "efs-sc"

# 메인 애플리케이션 프로덕션 설정
mainApp:
  enabled: true
  replicaCount: 3
  image:
    tag: "latest"
  
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi
  
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 20
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80

# 관리자 애플리케이션 프로덕션 설정
adminApp:
  enabled: true
  replicaCount: 2
  image:
    tag: "latest"
  
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi
  
  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 5
    targetCPUUtilizationPercentage: 80

# Ingress 프로덕션 설정
ingress:
  enabled: true
  className: "alb"
  annotations:
    kubernetes.io/ingress.class: alb
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/target-type: ip
    alb.ingress.kubernetes.io/ssl-redirect: '443'
    alb.ingress.kubernetes.io/certificate-arn: "arn:aws:acm:us-east-1:ACCOUNT_ID:certificate/CERT_ID"
    alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}, {"HTTPS": 443}]'
    alb.ingress.kubernetes.io/healthcheck-path: /api/health
    alb.ingress.kubernetes.io/healthcheck-interval-seconds: '30'
    alb.ingress.kubernetes.io/healthcheck-timeout-seconds: '5'
    alb.ingress.kubernetes.io/healthy-threshold-count: '2'
    alb.ingress.kubernetes.io/unhealthy-threshold-count: '3'
    alb.ingress.kubernetes.io/load-balancer-attributes: idle_timeout.timeout_seconds=60
  
  hosts:
    - host: msp.example.com
      paths:
        - path: /admin
          pathType: Prefix
          service: msp-checklist-admin-service
          port: 80
        - path: /
          pathType: Prefix
          service: msp-checklist-main-service
          port: 80

# 지속성 스토리지 프로덕션 설정
persistence:
  enabled: true
  storageClass: "efs-sc"
  accessMode: ReadWriteMany
  size: 20Gi

# 환경 변수 프로덕션 설정
config:
  nodeEnv: production
  logLevel: warn
  cacheTimeout: 7200
  maxFileSize: 52428800  # 50MB

# 보안 설정 강화
securityContext:
  runAsNonRoot: true
  runAsUser: 1001
  runAsGroup: 1001
  fsGroup: 1001
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: false
  capabilities:
    drop:
      - ALL

podSecurityContext:
  fsGroup: 1001
  runAsNonRoot: true
  runAsUser: 1001
  runAsGroup: 1001

# 헬스체크 프로덕션 설정
healthcheck:
  enabled: true
  livenessProbe:
    httpGet:
      path: /api/health
      port: http
    initialDelaySeconds: 60
    periodSeconds: 30
    timeoutSeconds: 10
    failureThreshold: 3
    successThreshold: 1
  
  readinessProbe:
    httpGet:
      path: /api/health
      port: http
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3
    successThreshold: 1

# 모니터링 활성화
monitoring:
  enabled: true
  serviceMonitor:
    enabled: true
    interval: 30s
    scrapeTimeout: 10s
    path: /metrics

# 네트워크 정책 활성화
networkPolicy:
  enabled: true
  ingress:
    - from:
        - namespaceSelector:
            matchLabels:
              name: kube-system
      ports:
        - protocol: TCP
          port: 3010
        - protocol: TCP
          port: 3011
  egress:
    - to: []
      ports:
        - protocol: TCP
          port: 443
        - protocol: TCP
          port: 80
        - protocol: UDP
          port: 53

# 백업 활성화
backup:
  enabled: true
  schedule: "0 2 * * *"
  retention: 30
  s3:
    enabled: true
    bucket: "msp-checklist-backups"
    region: us-east-1

# 로깅 설정
logging:
  enabled: true
  level: info
  format: json

# 메트릭 활성화
metrics:
  enabled: true
  port: 9090
  path: /metrics

# 알림 설정
alerts:
  enabled: true
  slack:
    webhook: "https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK"

# Pod 분산 설정
affinity:
  podAntiAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - msp-checklist
          topologyKey: kubernetes.io/hostname

# 리소스 쿼터
resourceQuota:
  enabled: true
  hard:
    requests.cpu: "4"
    requests.memory: 8Gi
    limits.cpu: "8"
    limits.memory: 16Gi
    persistentvolumeclaims: "2"

# Pod 중단 예산
podDisruptionBudget:
  enabled: true
  minAvailable: 1
  # maxUnavailable: 50%